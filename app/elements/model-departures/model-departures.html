<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/baasic-crud/baasic-crud.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/core-icon/core-icon.html">

<polymer-element name="model-departures" attributes="stationId">
    <template>
        <baasic-crud id="crudElement"
            geturl="{{baseUrl}}/{{version}}/station/{{stationId}}/departures/"
            on-get-completed="{{handleGetCompleted}}"
            on-get-error="{{handleGetError}}">
        </baasic-crud>

        <ul>
            <template repeat="{{ departure in data}}">
                <li>
                    {{ departure }}
                </li>
            </template>
        </ul>
    </template>
    <script>
        (function () {
            Polymer('model-departures', {
                baseUrl: 'http://localhost:8000/api',
                version: 'v1',
                data: [],
                domReady: function() {
                    return this.refresh();
                },
                refresh: function() {
                    return this.$.crudElement.get({});
                },
                handleGetCompleted: function(e, response, element) {
                    this.data = response.response;
                },
                handleGetError: function(e, response, element) {
                    console.log({handleGetError: response});
                    document.querySelector('#userNotifier').notify('Error getting station list');
                },
            });
        })();
    </script>
</polymer-element>
